module OTX
  module Indicator
    module IP
      class Malware < OTX::Type::Base
        def initialize(attributes={})
          attributes.each do |key, value|
            if key == 'hash'
              self.class.send(:attr_accessor, 'malware_hash')
              send('malware_hash=', value)
            else
              unless self.respond_to?(key)
                self.class.send(:attr_accessor, key)
              end
              send("#{key.downcase}=", value)
            end
          end
        end
      end
    end
  end
end
